
name: opencloud
networks:
  skynet:
    external: true
services:
  opencloud:
    container_name: opencloud
    hostname: opencloud
    image: opencloudeu/opencloud:latest
    user: ${OC_CONTAINER_UID_GID:-1000:1000}
    entrypoint:
       - /bin/sh
     # run opencloud init to initialize a configuration file with random secrets
     # it will fail on subsequent runs, because the config file already exists
     # therefore we ignore the error and then start the opencloud server
    command: ["-c", "opencloud init || true; opencloud server"]
    # extends:
    #   file: hwaccel.transcoding.yml
    #   service: cpu # set to one of [nvenc, quicksync, rkmpp, vaapi, vaapi-wsl] for accelerated transcoding
    volumes:
      # Do not edit the next line. If you want to change the media storage location on your system, edit the value of UPLOAD_LOCATION in the .env file
      - /srv/docker/opencloud/data:/var/lib/opencloud
      - /srv/docker/opencloud/config:/etc/opencloud
      - /etc/localtime:/etc/localtime:ro
    ports:
      - '9200:9200'
#    env_file: /srv/docker/opencloud/.env
    environment:
      OC_INSECURE: true
      PROXY_TLS: false
      #PROXY_HTTP_ADDR: 0.0.0.0:9200
      OC_URL: https://cloud.bitica.online
      OC_LOG_LEVEL: info
      #OC_STORAGE_USERS_MOUNT_ID: users
      #OC_SYSTEM_USER_ID: opencloud
      #OC_ADMIN_USERNAME: admin
      IDM_ADMIN_PASSWORD: admin-1234
      #OC_JWT_SECRET: 3c438750c914e97756895cead2021c5f8a75ed31cb7c3fe2a3b918d2b542ebc9
      #OC_TRANSFER_SECRET: 73d415472fafe2b5c82b03df7e230b2ad1cfb0c48e244a049c7b73f53e083914
      #OC_MACHINE_AUTH_API_KEY: b7ff5c2f8b6643b48f4f48922c66c97a75684665367dc7ca78d4e18c0747a0f5
      #OC_STORAGE_USERS_ROOT: /var/lib/opencloud/users
    restart: unless-stopped
    networks:
      - skynet
